Created Date：2024-01-20 15:38:56  
Last Modified：2024-01-20 15:38:56

# Tags

# Content

## 4.1 响应式数据与副作用函数

副作用函数：`effect` 函数的执行，直接或间接影响了其他函数的执行，这时函数产生了副作用  
响应式数据：值发生变化时，相关的 `effect` 函数自动重新执行

## 4.2 响应式数据的基本实现

- 副作用函数执行时，会触发值的读取 `get` 操作
- 设置值时，会触发值的设置 `set` 操作  

副作用函数执行时，涉及值的 `get` 操作，将副作用函数存入“桶”中：  
![[Pasted image 20240123141622.png]]  
设置/更新值时，涉及值的 `set` 操作，将副作用函数从”桶“中取出并执行：  
![[Pasted image 20240123141823.png]]  
代码：

```js
const bucket = new Set(); // 桶
const data = { text: 'Hello World' }; // 原始数据
function effect() {
  document.getElementById('txt').innerText = data.text;
}
new Proxy(data, {
  // 读取操作
  get(target, key) {
    bucket.add(effect); // 加入桶里
    return target[key];
  },
  // 修改操作
  set(target, key, value) {
    target[key] = value;
    bucket.forEach((fn) => fn());
    return true;
  }
});
```

# Reference
